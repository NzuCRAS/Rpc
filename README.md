**学习项目**

基于 ZooKeeper + Netty + Jackson + Sentinel + Prometheus

重点学习高并发/高可用/高性能的基本分布式服务体系的建立*

---

### 关于项目中的模块

#### client

编写客户端相关逻辑

- 客户端消息的发送与接收
- 心跳消息的读写
- 客户端代理的实现

#### common (未实现)

编写日志等中台应用

#### fault (未实现)

编写错误处理相关逻辑

#### loadBalance (未完成/未应用)

编写负载均衡(服务端挑选zk节点等)相关逻辑

#### metrics

编写Sentinel相关资源使用数据收集/处理相关逻辑

- 通过Prometheus收集resource的QPS/rt/error rate并通过HTTP展示
- 定时自动获取数据

##### 自动获取数据大致流程:

在业务代码中埋点 -> 将数据保存至本地内存 -> Prometheus通过HTTP将这些数据暴露至指定端口(/metrics路径)

同时最终还可以再使用Prometheus通过访问HTTP获取数据并将这些数据 存储/可视化 (未实现)

#### protocol

编写网络通信相关协议等

- 使用Jackson作为序列化/反序列化协议，从而实现网络通信时类对象的传输
- 编写了serializer接口，支持后续拓展多种序列化/反序列化协议
- 编写了RpcMessage作为客户端/服务端相互通信的基本格式，统一格式方便通信

#### registry

编写服务注册/发现相关逻辑

- 通过ZooKeeper实现服务的注册与发现，方便统一管理服务端节点/实现负载均衡等
- 编写了ServiceDiscovery/ServiceRegistry接口，方便后续拓展多种服务注册/发现方式

#### server

编写服务端相关逻辑

- 服务端消息的接收与发送
- 心跳信息的读写
- 编写了本地服务节点的实现，作为基本的服务节点实现方式
- 编写了服务的注册相关逻辑，调用registry中服务注册相关函数，实现了服务的本地注册
- 编写了服务端的消息/心跳处理逻辑，与后续流量治理相关逻辑兼容

#### stability*

编写流量治理相关逻辑(重点)(流量控制/熔断降级/系统保护)(基于Sentinel)

- 编写了流量治理多种方面的指标埋点(位于ServerHandler中)以及数据提取逻辑
- 编写了流量治理时根据数据自动调整服务规则的逻辑(通过ZooKeeper推送/更新)
- 编写了多粒度(ip级/接口级/参数级)的流量治理逻辑
- 编写了请求数据的基本格式ResourceStat，方便统一格式并提取/接收/发送/处理相关数据